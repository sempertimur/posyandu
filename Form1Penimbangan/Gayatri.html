<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Kelurahan Semper Timur</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.3/font/bootstrap-icons.css"
    />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="../table2excel.js"></script>
    <style>
      table,
      td {
        border: 2px solid black;
      }
    </style>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
    <script>
  
      function read_value(srchb,srcht) {
                
        var script_url = "https://script.google.com/macros/s/AKfycbwCJuJjrxB5-Jg_SfE1tpJ0XLXbUoYfZhTXjPDNXgYAJ_r3wFnCHh0AU5fmP9NchqTLpg/exec";
        
        var url = script_url + "?action=read";
        var l05s = 0;
        var p05s = 0;
        var jumlah05s = 0;
        var l611s = 0;
        var p611s = 0;
        var jumlah611s = 0;
        var l1223s = 0;
        var p1223s = 0;
        var jumlah1223s = 0;
        var l2459s = 0;
        var p2459s = 0;
        var jumlah2459s = 0;
        var jumlahs = 0;
        var l05d = 0;
        var p05d = 0;
        var jumlah05d = 0;
        var l611d = 0;
        var p611d = 0;
        var jumlah611d = 0;
        var l1223d = 0;
        var p1223d = 0;
        var jumlah1223d = 0;
        var l2459d = 0;
        var p2459d = 0;
        var jumlah2459d = 0;
        var jumlahd = 0;
        var l05n = 0;
        var p05n = 0;
        var l611n = 0;
        var p611n = 0;
        var l1223n = 0;
        var p1223n = 0;
        var l2459n = 0;
        var p2459n = 0;
        var jumlahn = 0;
        var l05t = 0;
        var p05t = 0;
        var l611t = 0;
        var p611t = 0;
        var l1223t = 0;
        var p1223t = 0;
        var l2459t = 0;
        var p2459t = 0;
        var jumlaht = 0;
        var l05o = 0;
        var p05o = 0;
        var l611o = 0;
        var p611o = 0;
        var l1223o = 0;
        var p1223o = 0;
        var l2459o = 0;
        var p2459o = 0;
        var jumlaho = 0;
        var l05b = 0;
        var p05b = 0;
        var l611b = 0;
        var p611b = 0;
        var l1223b = 0;
        var p1223b = 0;
        var l2459b = 0;
        var p2459b = 0;
        var jumlahb = 0;
        $.getJSON(url, function (json) {
          //        alert(json.records);
          // masukkan data ke dalam tabel
          if (srchb != "") {
            for (var i = 0; i < json.records.length; i++) {
              if (
                json.records[i].usiasekarang != "" &&
                json.records[i].usiasekarang != "-"
              ) {
                if (
                  srchb == json.records[i].bulan &&
                  srcht == json.records[i].tahun
                ) {
                  if (
                    json.records[i].usiasekarang <= 5 &&
                    (json.records[i].kelamin == "LAKI - LAKI" ||
                      json.records[i].kelamin == "Laki-Laki")
                  ) {
                    l05s = l05s + 1;
                  } else if (
                    json.records[i].usiasekarang <= 5 &&
                    (json.records[i].kelamin == "PEREMPUAN" ||
                      json.records[i].kelamin == "Perempuan")
                  ) {
                    p05s = p05s + 1;
                  } else if (
                    json.records[i].usiasekarang <= 11 &&
                    (json.records[i].kelamin == "LAKI - LAKI" ||
                      json.records[i].kelamin == "Laki-Laki")
                  ) {
                    l611s = l611s + 1;
                  } else if (
                    json.records[i].usiasekarang <= 11 &&
                    (json.records[i].kelamin == "PEREMPUAN" ||
                      json.records[i].kelamin == "Perempuan")
                  ) {
                    p611s = p611s + 1;
                  } else if (
                    json.records[i].usiasekarang <= 23 &&
                    (json.records[i].kelamin == "LAKI - LAKI" ||
                      json.records[i].kelamin == "Laki-Laki")
                  ) {
                    l1223s = l1223s + 1;
                  } else if (
                    json.records[i].usiasekarang <= 23 &&
                    (json.records[i].kelamin == "PEREMPUAN" ||
                      json.records[i].kelamin == "Perempuan")
                  ) {
                    p1223s = p1223s + 1;
                  } else if (
                    json.records[i].usiasekarang <= 59 &&
                    (json.records[i].kelamin == "LAKI - LAKI" ||
                      json.records[i].kelamin == "Laki-Laki")
                  ) {
                    l2459s = l2459s + 1;
                  } else if (
                    json.records[i].usiasekarang <= 59 &&
                    (json.records[i].kelamin == "PEREMPUAN" ||
                      json.records[i].kelamin == "Perempuan")
                  ) {
                    p2459s = p2459s + 1;
                  }
                  if (
                    json.records[i].usiasekarang <= 5 &&
                    (json.records[i].kelamin == "LAKI - LAKI" ||
                      json.records[i].kelamin == "Laki-Laki") &&
                    json.records[i].bbsekarang != "" &&
                    json.records[i].bbsekarang != "-"
                  ) {
                    l05d = l05d + 1;
                  } else if (
                    json.records[i].usiasekarang <= 5 &&
                    (json.records[i].kelamin == "PEREMPUAN" ||
                      json.records[i].kelamin == "Perempuan") &&
                    json.records[i].bbsekarang != "" &&
                    json.records[i].bbsekarang != "-"
                  ) {
                    p05d = p05d + 1;
                  } else if (
                    json.records[i].usiasekarang <= 11 &&
                    (json.records[i].kelamin == "LAKI - LAKI" ||
                      json.records[i].kelamin == "Laki-Laki") &&
                    json.records[i].bbsekarang != "" &&
                    json.records[i].bbsekarang != "-"
                  ) {
                    l611d = l611d + 1;
                  } else if (
                    json.records[i].usiasekarang <= 11 &&
                    (json.records[i].kelamin == "PEREMPUAN" ||
                      json.records[i].kelamin == "Perempuan") &&
                    json.records[i].bbsekarang != "" &&
                    json.records[i].bbsekarang != "-"
                  ) {
                    p611d = p611d + 1;
                  } else if (
                    json.records[i].usiasekarang <= 23 &&
                    (json.records[i].kelamin == "LAKI - LAKI" ||
                      json.records[i].kelamin == "Laki-Laki") &&
                    json.records[i].bbsekarang != "" &&
                    json.records[i].bbsekarang != "-"
                  ) {
                    l1223d = l1223d + 1;
                  } else if (
                    json.records[i].usiasekarang <= 23 &&
                    (json.records[i].kelamin == "PEREMPUAN" ||
                      json.records[i].kelamin == "Perempuan") &&
                    json.records[i].bbsekarang != "" &&
                    json.records[i].bbsekarang != "-"
                  ) {
                    p1223d = p1223d + 1;
                  } else if (
                    json.records[i].usiasekarang <= 59 &&
                    (json.records[i].kelamin == "LAKI - LAKI" ||
                      json.records[i].kelamin == "Laki-Laki") &&
                    json.records[i].bbsekarang != "" &&
                    json.records[i].bbsekarang != "-"
                  ) {
                    l2459d = l2459d + 1;
                  } else if (
                    json.records[i].usiasekarang <= 59 &&
                    (json.records[i].kelamin == "PEREMPUAN" ||
                      json.records[i].kelamin == "Perempuan") &&
                    json.records[i].bbsekarang != "" &&
                    json.records[i].bbsekarang != "-"
                  ) {
                    p2459d = p2459d + 1;
                  }
                }
              }
            }
            jumlahs =
              l05s + p05s + l611s + p611s + l1223s + p1223s + l2459s + p2459s;
            jumlahd =
              l05d + p05d + l611d + p611d + l1223d + p1223d + l2459d + p2459d;
            jumlah05s = l05s + p05s;
            jumlah611s = l611s + p611s;
            jumlah1223s = l1223s + p1223s;
            jumlah2459s = l2459s + p2459s;
            jumlah05d = l05d + p05d;
            jumlah611d = l611d + p611d;
            jumlah1223d = l1223d + p1223d;
            jumlah2459d = l2459d + p2459d;
          }

          var divContainer = document.getElementById("showData");
          divContainer.innerHTML =
            "<table class='table table-bordered ps-2 text-center'><tr><td rowspan='3'>No</td><td rowspan='3'>Uraian Kegiatan</td><td colspan='12'>Kelompok Umur</td><td rowspan='3'>Jumlah Keseluruhan</td></tr><tr><td colspan='3'>0-5 Bulan</td><td colspan='3'>6-11 Bulan</td><td colspan='3'>12-23 Bulan</td><td colspan='3'>24-59 Bulan</td></tr><tr><td>L</td><td>P</td><td>jumlah</td><td>L</td><td>P</td><td>jumlah</td><td>L</td><td>P</td><td>jumlah</td><td>L</td><td>P</td><td>jumlah</td></tr><tr><td>1</td><td>Jumlah Bayi (S)</td><td>" +
            l05s +
            "</td><td>" +
            p05s +
            "</td><td>" +
            jumlah05s +
            "</td><td>" +
            l611s +
            "</td><td>" +
            p611s +
            "</td><td>" +
            jumlah611s +
            "</td><td>" +
            l1223s +
            "</td><td>" +
            p1223s +
            "</td><td>" +
            jumlah1223s +
            "</td><td>" +
            l2459s +
            "</td><td>" +
            p2459s +
            "</td><td>" +
            jumlah2459s +
            "</td><td>" +
            jumlahs +
            "</td></tr><tr><td>2</td><td>Jumlah Bayi Yang Memiliki KMS (K)</td><td>" +
            l05s +
            "</td><td>" +
            p05s +
            "</td><td>" +
            jumlah05s +
            "</td><td>" +
            l611s +
            "</td><td>" +
            p611s +
            "</td><td>" +
            jumlah611s +
            "</td><td>" +
            l1223s +
            "</td><td>" +
            p1223s +
            "</td><td>" +
            jumlah1223s +
            "</td><td>" +
            l2459s +
            "</td><td>" +
            p2459s +
            "</td><td>" +
            jumlah2459s +
            "</td><td>" +
            jumlahs +
            "</td></tr><tr><td>3</td><td>Jumlah Bayi Ditimbang (D)</td><td>" +
            l05d +
            "</td><td>" +
            p05d +
            "</td><td>" +
            jumlah05d +
            "</td><td>" +
            l611d +
            "</td><td>" +
            p611d +
            "</td><td>" +
            jumlah611d +
            "</td><td>" +
            l1223d +
            "</td><td>" +
            p1223d +
            "</td><td>" +
            jumlah1223d +
            "</td><td>" +
            l2459d +
            "</td><td>" +
            p2459d +
            "</td><td>" +
            jumlah2459d +
            "</td><td>" +
            jumlahd +
            "</td></tr><tr><td rowspan='5'>4</td><td>Hasil Penimbangan Sesuai Rambu Gizi</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>N (Naik)</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>T (Tidak Naik)</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><tr><td>O (Bulan Lalu Tidak Datang Menimbang)</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>B (Baru Pertama Kali Datang Menimbang)</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>5</td><td>Jumlah Balita Bawah Garis Merah (BGM)</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>6</td><td>Jumlah Balita BGM yang di Rujuk ke Puskesmas</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>7</td><td>Jumlah Balita Atas Pita Hijau (APH)</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>8</td><td>Jumlah Balita APH yang di Rujuk ke Puskesmas</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>9</td><td>Jumlah Bayi yang Tidak Naik Berat</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>10</td><td>Jumlah Bayi yang Tidak Naik Berat</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></table>";
          divContainer.appendChild(table);

          getData2Input(); ///////////////////
        });
      }
      function cetak(el){
        var restorepage = document.body.innerHTML;
        var printcontent = document.getElementById(el).innerHTML;
        document.body.innerHTML=printcontent;
        window.print();
        document.body.innerHTML=restorepage;
      }
    </script>
  </head>
  <body id="home">

<nav
class="navbar navbar-expand-lg navbar-dark bg-primary shadow-sm fixed-top"
>
<div class="container">
  <a class="navbar-brand fs-4"
    ><img src="../img/logo.png" width="35" />&emsp;Kelurahan Semper
    Timur</a
  >
  <button
    class="navbar-toggler"
    type="button"
    data-bs-toggle="collapse"
    data-bs-target="#navbarNav"
    aria-controls="navbarNav"
    aria-expanded="false"
    aria-label="Toggle navigation"
  >
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse navbar-collapse" id="navbarNav">
    <ul class="navbar-nav ms-auto">
      <li class="nav-item">
        <a class="nav-link" href="../BalitaHadir/Gayatri.html"
          >Form Balita Hadir</a
        >
      </li>
      <li class="nav-item">
        <a class="nav-link" href="../Formulir/Gayatri.html">Form Balita Baru</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="../Tampil/Gayatri.html">Rekapitulasi Data</a>
      </li>
      <li class="nav-item">
        <a class="nav-link active" aria-current="page">Form 1</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="../index.html">Logout</a>
      </li>
    </ul>
  </div>
</div>
</nav>
    
    <section id="projects">
      <div class="row">
        <div style="padding-top: 5rem" class="fw-bolder fs-3 text-center pb-3">
          DATA POSYANDU KELURAHAN SEMPER TIMUR
        </div>
        <div class="container px-4">
        <div class="row">
          <div class="col-md-5 mb-3">
           <div class="p-2 border bg-light">
            <select class="form-select form-select-sm" aria-label=".form-select-sm example" name="srchb" id="srchbulan">
              <option selected>Silahkan Pilih Bulan</option>
              <option value="Januari">Januari</option>
              <option value="Februari">Februari</option>
              <option value="Maret">Maret</option>
              <option value="April">April</option>
              <option value="Mei">Mei</option>
              <option value="Juni">Juni</option>
              <option value="Juli">Juli</option>
              <option value="Agustus">Agustus</option>
              <option value="September">September</option>
              <option value="Oktober">Oktober</option>
              <option value="November">November</option>
              <option value="Desember">Desember</option>
            </select>
           </div>
          </div>
          <div class="col-md-5 mb-3">
            <div class="p-2 border bg-light">
              <select class="form-select form-select-sm" aria-label=".form-select-sm example" name="srcht" id="srchtahun">
                <option selected>Silahkan Pilih Tahun</option>
                <option value="2022">2022</option>
                <option value="2023">2023</option>
                <option value="2024">2024</option>
                <option value="2025">2025</option>
                <option value="2026">2026</option>
                <option value="2027">2027</option>
                <option value="2028">2028</option>
                <option value="2029">2029</option>
                <option value="2030">2030</option>
                <option value="2031">2031</option>
              </select>
            </div>
          </div>
          <div class="col-md-1 pt-2">
            <div class="">
                <input type="button" class="btn btn-success" onclick="read_value($('#srchbulan').val(),$('#srchtahun').val())" value="Tampilkan"/>
            </div>
          </div>
          <div class="col-md-1 pt-2">
            <input type="button" class="btn btn-success" onclick="cetak('showData')" value="Cetak"/>
          </div>
        </div>
      </div>           
    </div>  
    <div id="showData" class="table fs-6" style="padding-top: 25pt;padding-bottom: 75pt;padding-left: 10pt;padding-right: 10pt;"></div>
      </div>
    </section>
    <!-- Akhir Project -->
    <svg
      id="wave"
      style="transform: rotate(0deg); transition: 0.3s"
      viewBox="0 0 1440 100"
      version="1.1"
      xmlns="http://www.w3.org/2000/svg"
      class="fixed-bottom"
    >
      <defs>
        <linearGradient id="sw-gradient-0" x1="0" x2="0" y1="1" y2="0">
          <stop stop-color="rgba(13, 110, 253, 1)" offset="0%"></stop>
          <stop stop-color="rgba(13, 110, 253, 1)" offset="100%"></stop>
        </linearGradient>
      </defs>
      <path
        style="transform: translate(0, 0px); opacity: 1"
        fill="url(#sw-gradient-0)"
        d="M0,10L30,11.7C60,13,120,17,180,18.3C240,20,300,20,360,26.7C420,33,480,47,540,51.7C600,57,660,53,720,51.7C780,50,840,50,900,41.7C960,33,1020,17,1080,18.3C1140,20,1200,40,1260,40C1320,40,1380,20,1440,21.7C1500,23,1560,47,1620,46.7C1680,47,1740,23,1800,16.7C1860,10,1920,20,1980,20C2040,20,2100,10,2160,10C2220,10,2280,20,2340,28.3C2400,37,2460,43,2520,51.7C2580,60,2640,70,2700,76.7C2760,83,2820,87,2880,88.3C2940,90,3000,90,3060,78.3C3120,67,3180,43,3240,31.7C3300,20,3360,20,3420,25C3480,30,3540,40,3600,41.7C3660,43,3720,37,3780,40C3840,43,3900,57,3960,53.3C4020,50,4080,30,4140,28.3C4200,27,4260,43,4290,51.7L4320,60L4320,100L4290,100C4260,100,4200,100,4140,100C4080,100,4020,100,3960,100C3900,100,3840,100,3780,100C3720,100,3660,100,3600,100C3540,100,3480,100,3420,100C3360,100,3300,100,3240,100C3180,100,3120,100,3060,100C3000,100,2940,100,2880,100C2820,100,2760,100,2700,100C2640,100,2580,100,2520,100C2460,100,2400,100,2340,100C2280,100,2220,100,2160,100C2100,100,2040,100,1980,100C1920,100,1860,100,1800,100C1740,100,1680,100,1620,100C1560,100,1500,100,1440,100C1380,100,1320,100,1260,100C1200,100,1140,100,1080,100C1020,100,960,100,900,100C840,100,780,100,720,100C660,100,600,100,540,100C480,100,420,100,360,100C300,100,240,100,180,100C120,100,60,100,30,100L0,100Z"
      ></path>
    </svg>
    <footer class="text-white text-center fixed-bottom pb-1">
      <p>&copy; 2022 Kelurahan Semper Timur</p>
    </footer>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
